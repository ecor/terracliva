% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spicliva.R
\name{spicliva}
\alias{spicliva}
\title{SPI / SPEI index  (see lmomPi implementation)}
\usage{
spicliva(x, timex, distrib = "pe3", spi.scale = 1, index = "monthly", ...)
}
\arguments{
\item{x}{time series (e.g. monthly precipitation)}

\item{timex}{corresponding vector of dates for \code{x}. It is a vector of dates of each first day of the month}

\item{distrib}{probability distribution function. See \code{\link{pel}}}

\item{spi.scale}{integer value or \code{NA}. If it greater than 1 \code{x} is filtered with the sum of a generic element of \code{x} and the previous \code{spi.scale-1} ones (e.g. SPI-3,SPI-6, etc. ). Default is \code{NA} (no filtering) which is equivalent to \code{spi.scale=1}.}

\item{...}{further arguments}

\item{na.rm}{a logical evaluating to \code{TRUE} or \code{FALSE} or something else indicating whether or how many NA values should be stripped before the computation proceeds. Details in function code.}
}
\description{
SPI / SPEI index  (see lmomPi implementation)
}
\note{
\code{x} must have the proper time aggregation for the analysis before the execution of this function.
}
\examples{

library(magrittr)
library(terra)
library(lmomPi)

years <- 1982:2023



dataset_path <- system.file("ext_data/precipitation",package="terracliva")
dataset_monthly <- "\%s/monthly/chirps_monthly_goma_\%04d.grd" \%>\% sprintf(dataset_path,years) \%>\% rast()
terra::time(dataset_monthly) <-  names(dataset_monthly) \%>\% paste0("_01") \%>\% as.Date(format="X\%Y_\%m_\%d")

prec <- as.numeric(dataset_monthly[100])
timeprec <- terra::time(dataset_monthly)
spi1 <- spicliva(x=prec,timex=timeprec,distrib="pe3")
spi1 <- spicliva(x=prec,timex=timeprec)
spi3 <- spicliva(x=prec,timex=timeprec,spi.scale=3)


}
\seealso{
\code{\link{spi.cdf}}
}
